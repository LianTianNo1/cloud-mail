import{K as Y,aw as Z,P as A,b as Ie,aG as Ve,I as W,d as le,a9 as ce,s as ne,k as b,a3 as ke,u as te,bj as Ne,bk as Me,aP as Pe,j as fe,_ as Be,a as ve,bl as Re,c as j,o as M,e as G,f as K,g as a,n as V,r as ee,A as oe,F as xe,a5 as ze,y as H,z as ae,h as Ae,t as se,D as re,bm as Fe,aJ as Le,b6 as $e,C as Ke,N as Oe,bn as Ue,aS as qe,E as ie,B as je,i as Ge,w as He}from"./index-CrVLGAV5.js";import{t as ue,E as We}from"./el-popper-CxTMhn_i.js";import{I as ge,C as z,U as O}from"./event-BB_Ol6Sd.js";import{d as Je,a as Xe,b as Qe,c as Ye}from"./index-B5LOEhaN.js";import{c as Ze,d as ea,u as aa}from"./vnode-DMmxwG2F.js";import{d as de}from"./index-xJ5jWlCl.js";import{c as ta,u as na}from"./el-select-C7rgYuUX.js";const la=Ie({modelValue:{type:le(Array)},max:Number,tagType:{...ue.type,default:"info"},tagEffect:ue.effect,trigger:{type:le(String),default:W.enter},draggable:Boolean,delimiter:{type:[String,RegExp],default:""},size:Ve,clearable:Boolean,disabled:{type:Boolean,default:void 0},validateEvent:{type:Boolean,default:!0},readonly:Boolean,autofocus:Boolean,id:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},maxlength:{type:[String,Number]},minlength:{type:[String,Number]},placeholder:String,autocomplete:{type:String,default:"off"},saveOnBlur:{type:Boolean,default:!0},ariaLabel:String}),oa={[O]:e=>Z(e)||A(e),[z]:e=>Z(e)||A(e),[ge]:e=>Y(e),"add-tag":e=>Y(e)||Z(e),"remove-tag":e=>Y(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0};function sa({props:e,emit:s,formItem:d}){const p=Je(),_=Xe(),h=ce(),l=ne(),c=b(()=>["small"].includes(_.value)?"small":"default"),C=b(()=>{var t;return(t=e.modelValue)!=null&&t.length?void 0:e.placeholder}),i=b(()=>!(e.readonly||p.value)),f=b(()=>{var t,n;return A(e.max)?!1:((n=(t=e.modelValue)==null?void 0:t.length)!=null?n:0)>=e.max}),r=t=>{var n;const g=[...(n=e.modelValue)!=null?n:[],...ta(t)];s(O,g),s(z,g),s("add-tag",t),l.value=void 0},P=t=>{var n,g;const E=t.split(e.delimiter).filter(S=>S&&S!==t);if(e.max){const S=e.max-((g=(n=e.modelValue)==null?void 0:n.length)!=null?g:0);E.splice(S)}return E.length===1?E[0]:E},w=t=>{if(f.value){l.value=void 0;return}if(!T.value){if(e.delimiter&&l.value){const n=P(l.value);n.length&&r(n)}s(ge,t.target.value)}},v=t=>{var n;if(!T.value)switch(t.code){case e.trigger:t.preventDefault(),t.stopPropagation(),o();break;case W.numpadEnter:e.trigger===W.enter&&(t.preventDefault(),t.stopPropagation(),o());break;case W.backspace:!l.value&&((n=e.modelValue)!=null&&n.length)&&(t.preventDefault(),t.stopPropagation(),m(e.modelValue.length-1));break}},o=()=>{var t;const n=(t=l.value)==null?void 0:t.trim();!n||f.value||r(n)},m=t=>{var n;const g=((n=e.modelValue)!=null?n:[]).slice(),[E]=g.splice(t,1);s(O,g),s(z,g),s("remove-tag",E)},I=()=>{l.value=void 0,s(O,void 0),s(z,void 0),s("clear")},y=(t,n,g)=>{var E;const S=((E=e.modelValue)!=null?E:[]).slice(),[J]=S.splice(t,1),X=n>t&&g==="before"?-1:n<t&&g==="after"?1:0;S.splice(n+X,0,J),s(O,S),s(z,S)},D=()=>{var t;(t=h.value)==null||t.focus()},R=()=>{var t;(t=h.value)==null||t.blur()},{wrapperRef:F,isFocused:x}=Ze(h,{disabled:p,afterBlur(){var t;e.saveOnBlur?o():l.value=void 0,e.validateEvent&&((t=d?.validate)==null||t.call(d,"blur").catch(n=>de()))}}),{isComposing:T,handleCompositionStart:k,handleCompositionUpdate:L,handleCompositionEnd:B}=ea({afterComposition:w});return ke(()=>e.modelValue,()=>{var t;e.validateEvent&&((t=d?.validate)==null||t.call(d,z).catch(n=>de()))}),{inputRef:h,wrapperRef:F,isFocused:x,isComposing:T,inputValue:l,size:_,tagSize:c,placeholder:C,closable:i,disabled:p,inputLimit:f,handleDragged:y,handleInput:w,handleKeydown:v,handleAddTag:o,handleRemoveTag:m,handleClear:I,handleCompositionStart:k,handleCompositionUpdate:L,handleCompositionEnd:B,focus:D,blur:R}}function ra(){const e=ne(!1);return{hovering:e,handleMouseEnter:()=>{e.value=!0},handleMouseLeave:()=>{e.value=!1}}}function ia({wrapperRef:e,handleDragged:s,afterDragged:d}){const p=te("input-tag"),_=ce(),h=ne(!1);let l,c,C,i;function f(v){return`.${p.e("inner")} .${p.namespace.value}-tag:nth-child(${v+1})`}function r(v,o){l=o,c=e.value.querySelector(f(o)),c&&(c.style.opacity="0.5"),v.dataTransfer.effectAllowed="move"}function P(v,o){if(C=o,v.preventDefault(),v.dataTransfer.dropEffect="move",A(l)||l===o){h.value=!1;return}const m=e.value.querySelector(f(o)).getBoundingClientRect(),I=l+1!==o,y=l-1!==o,D=v.clientX-m.left,R=I?y?.5:1:-1,F=y?I?.5:0:1;D<=m.width*R?i="before":D>m.width*F?i="after":i=void 0;const x=e.value.querySelector(`.${p.e("inner")}`),T=x.getBoundingClientRect(),k=Number.parseFloat(Ne(x,"gap"))/2,L=m.top-T.top;let B=-9999;if(i==="before")B=Math.max(m.left-T.left-k,Math.floor(-k/2));else if(i==="after"){const t=m.right-T.left;B=t+(T.width===t?Math.floor(k/2):k)}Me(_.value,{top:`${L}px`,left:`${B}px`}),h.value=!!i}function w(v){v.preventDefault(),c&&(c.style.opacity=""),i&&!A(l)&&!A(C)&&l!==C&&s(l,C,i),h.value=!1,l=void 0,c=null,C=void 0,i=void 0,d?.()}return{dropIndicatorRef:_,showDropIndicator:h,handleDragStart:r,handleDragOver:P,handleDragEnd:w}}function ua({props:e,isFocused:s,hovering:d,disabled:p,inputValue:_,size:h,validateState:l,validateIcon:c,needStatusIcon:C}){const i=Pe(),f=fe(),r=te("input-tag"),P=te("input"),w=b(()=>[r.b(),r.is("focused",s.value),r.is("hovering",d.value),r.is("disabled",p.value),r.m(h.value),r.e("wrapper"),i.class]),v=b(()=>[i.style]),o=b(()=>{var y,D;return[r.e("inner"),r.is("draggable",e.draggable),r.is("left-space",!((y=e.modelValue)!=null&&y.length)&&!f.prefix),r.is("right-space",!((D=e.modelValue)!=null&&D.length)&&!I.value)]}),m=b(()=>{var y;return e.clearable&&!p.value&&!e.readonly&&(((y=e.modelValue)==null?void 0:y.length)||_.value)&&(s.value||d.value)}),I=b(()=>f.suffix||m.value||l.value&&c.value&&C.value);return{ns:r,nsInput:P,containerKls:w,containerStyle:v,innerKls:o,showClear:m,showSuffix:I}}const da=ve({name:"ElInputTag",inheritAttrs:!1}),ca=ve({...da,props:la,emits:oa,setup(e,{expose:s,emit:d}){const p=e,_=aa(),h=fe(),{form:l,formItem:c}=Qe(),{inputId:C}=Ye(p,{formItemContext:c}),i=b(()=>{var u;return(u=l?.statusIcon)!=null?u:!1}),f=b(()=>c?.validateState||""),r=b(()=>f.value&&Re[f.value]),{inputRef:P,wrapperRef:w,isFocused:v,inputValue:o,size:m,tagSize:I,placeholder:y,closable:D,disabled:R,handleDragged:F,handleInput:x,handleKeydown:T,handleRemoveTag:k,handleClear:L,handleCompositionStart:B,handleCompositionUpdate:t,handleCompositionEnd:n,focus:g,blur:E}=sa({props:p,emit:d,formItem:c}),{hovering:S,handleMouseEnter:J,handleMouseLeave:X}=ra(),{calculatorRef:pe,inputStyle:me}=na(),{dropIndicatorRef:he,showDropIndicator:ye,handleDragStart:be,handleDragOver:Ce,handleDragEnd:Ee}=ia({wrapperRef:w,handleDragged:F,afterDragged:g}),{ns:N,nsInput:Q,containerKls:Se,containerStyle:De,innerKls:Te,showClear:_e,showSuffix:we}=ua({props:p,hovering:S,isFocused:v,inputValue:o,disabled:R,size:m,validateState:f,validateIcon:r,needStatusIcon:i});return s({focus:g,blur:E}),(u,va)=>(M(),j("div",{ref_key:"wrapperRef",ref:w,class:V(a(Se)),style:Ge(a(De)),onMouseenter:a(J),onMouseleave:a(X)},[a(h).prefix?(M(),j("div",{key:0,class:V(a(N).e("prefix"))},[ee(u.$slots,"prefix")],2)):G("v-if",!0),K("div",{class:V(a(Te))},[(M(!0),j(xe,null,ze(u.modelValue,(U,$)=>(M(),H(a(We),{key:$,size:a(I),closable:a(D),type:u.tagType,effect:u.tagEffect,draggable:a(D)&&u.draggable,"disable-transitions":"",onClose:q=>a(k)($),onDragstart:q=>a(be)(q,$),onDragover:q=>a(Ce)(q,$),onDragend:a(Ee),onDrop:re(()=>{},["stop"])},{default:ae(()=>[ee(u.$slots,"tag",{value:U,index:$},()=>[Ae(se(U),1)])]),_:2},1032,["size","closable","type","effect","draggable","onClose","onDragstart","onDragover","onDragend","onDrop"]))),128)),K("div",{class:V(a(N).e("input-wrapper"))},[oe(K("input",Le({id:a(C),ref_key:"inputRef",ref:P,"onUpdate:modelValue":U=>$e(o)?o.value=U:null},a(_),{type:"text",minlength:u.minlength,maxlength:u.maxlength,disabled:a(R),readonly:u.readonly,autocomplete:u.autocomplete,tabindex:u.tabindex,placeholder:a(y),autofocus:u.autofocus,ariaLabel:u.ariaLabel,class:a(N).e("input"),style:a(me),onCompositionstart:a(B),onCompositionupdate:a(t),onCompositionend:a(n),onInput:a(x),onKeydown:a(T)}),null,16,["id","onUpdate:modelValue","minlength","maxlength","disabled","readonly","autocomplete","tabindex","placeholder","autofocus","ariaLabel","onCompositionstart","onCompositionupdate","onCompositionend","onInput","onKeydown"]),[[Fe,a(o)]]),K("span",{ref_key:"calculatorRef",ref:pe,"aria-hidden":"true",class:V(a(N).e("input-calculator")),textContent:se(a(o))},null,10,["textContent"])],2),oe(K("div",{ref_key:"dropIndicatorRef",ref:he,class:V(a(N).e("drop-indicator"))},null,2),[[Ke,a(ye)]])],2),a(we)?(M(),j("div",{key:1,class:V(a(N).e("suffix"))},[ee(u.$slots,"suffix"),a(_e)?(M(),H(a(ie),{key:0,class:V([a(N).e("icon"),a(N).e("clear")]),onMousedown:re(a(qe),["prevent"]),onClick:a(L)},{default:ae(()=>[Oe(a(Ue))]),_:1},8,["class","onMousedown","onClick"])):G("v-if",!0),a(f)&&a(r)&&a(i)?(M(),H(a(ie),{key:1,class:V([a(Q).e("icon"),a(Q).e("validateIcon"),a(Q).is("loading",a(f)==="validating")])},{default:ae(()=>[(M(),H(je(a(r))))]),_:1},8,["class"])):G("v-if",!0)],2)):G("v-if",!0)],46,["onMouseenter","onMouseleave"]))}});var fa=Be(ca,[["__file","input-tag.vue"]]);const Ea=He(fa);export{Ea as E};
