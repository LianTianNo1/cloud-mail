import{X as B,a1 as U,Y as C,s as p,a2 as b,c as v,f as s,A,N as i,t,g as V,z as f,a0 as u,V as D,o as w,h as y,ai as I,aj as T,W as j}from"./index-CrVLGAV5.js";import{E as L}from"./el-dialog-Dc-uwvKn.js";/* empty css                       *//* empty css                  *//* empty css                 */import{d as z}from"./account-CAuW78YI.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{E as O}from"./vnode-DMmxwG2F.js";import{E as W}from"./index-Bi5OiBjY.js";import{E as X}from"./index-BqKRmYx7.js";import"./event-BB_Ol6Sd.js";import"./index-B5LOEhaN.js";import"./index-xJ5jWlCl.js";const Y={class:"box"},q={class:"container"},G={class:"title"},H={class:"item"},J={key:0,class:"edit-name-input"},K={key:1,class:"user-name"},Q={class:"item"},R={class:"item"},Z={class:"del-email"},x={class:"title"},ee={style:{color:"var(--regular-text-color)"}},se={class:"update-pwd"},te=Object.assign({name:"setting"},{__name:"index",setup(ae){const{t:o}=B(),$=U(),r=C(),c=p(!1),g=p(!1),d=p(null);function P(){d.value=r.user.name,g.value=!0}function S(){if(!d.value){u({message:o("emptyUserNameMsg"),type:"error",plain:!0});return}g.value=!1;let e=d.value;e!==r.user.name&&(r.user.name=d.value,z(r.user.accountId,e).then(()=>{u({message:o("saveSuccessMsg"),type:"success",plain:!0}),$.changeUserAccountName=e}).catch(()=>{r.user.name=e}))}const m=p(!1),a=b({password:"",newPwd:""}),N=()=>{X.confirm(o("delAccountConfirm"),{confirmButtonText:o("confirm"),cancelButtonText:o("cancel"),type:"warning"}).then(()=>{T().then(()=>{localStorage.removeItem("token"),j.replace("/login"),u({message:o("delSuccessMsg"),type:"success",plain:!0})})})};function k(){if(!a.password){u({message:o("emptyPwdMsg"),type:"error",plain:!0});return}if(a.password.length<6){u({message:o("pwdLengthMsg"),type:"error",plain:!0});return}if(a.password!==a.newPwd){u({message:o("confirmPwdFailMsg"),type:"error",plain:!0});return}c.value=!0,I(a.password).then(()=>{u({message:o("saveSuccessMsg"),type:"success",plain:!0}),m.value=!1,c.value=!1,a.password="",a.newPwd=""}).catch(()=>{c.value=!1})}return(e,l)=>{const _=O,h=W,E=L,M=D("perm");return w(),v("div",Y,[s("div",q,[s("div",G,t(e.$t("profile")),1),s("div",H,[s("div",null,t(e.$t("username")),1),s("div",null,[g.value?(w(),v("span",J,[i(_,{modelValue:d.value,"onUpdate:modelValue":l[0]||(l[0]=n=>d.value=n)},null,8,["modelValue"]),s("span",{class:"edit-name",onClick:S},t(e.$t("save")),1)])):(w(),v("span",K,[s("span",null,t(V(r).user.name),1),s("span",{class:"edit-name",onClick:P},t(e.$t("change")),1)]))])]),s("div",Q,[s("div",null,t(e.$t("emailAccount")),1),s("div",null,t(V(r).user.email),1)]),s("div",R,[s("div",null,t(e.$t("password")),1),s("div",null,[i(h,{type:"primary",onClick:l[1]||(l[1]=n=>m.value=!0)},{default:f(()=>[y(t(e.$t("changePwdBtn")),1)]),_:1})])])]),A((w(),v("div",Z,[s("div",x,t(e.$t("deleteUser")),1),s("div",ee,t(e.$t("delAccountMsg")),1),s("div",null,[i(h,{type:"primary",onClick:N},{default:f(()=>[y(t(e.$t("deleteUserBtn")),1)]),_:1})])])),[[M,"my:delete"]]),i(E,{modelValue:m.value,"onUpdate:modelValue":l[4]||(l[4]=n=>m.value=n),title:e.$t("changePassword"),width:"340"},{default:f(()=>[s("div",se,[i(_,{type:"password",placeholder:e.$t("newPassword"),modelValue:a.password,"onUpdate:modelValue":l[2]||(l[2]=n=>a.password=n),autocomplete:"off"},null,8,["placeholder","modelValue"]),i(_,{type:"password",placeholder:e.$t("confirmPassword"),modelValue:a.newPwd,"onUpdate:modelValue":l[3]||(l[3]=n=>a.newPwd=n),autocomplete:"off"},null,8,["placeholder","modelValue"]),i(h,{type:"primary",loading:c.value,onClick:k},{default:f(()=>[y(t(e.$t("save")),1)]),_:1},8,["loading"])])]),_:1},8,["modelValue","title"])])}}}),ge=F(te,[["__scopeId","data-v-1b447be1"]]);export{ge as default};
